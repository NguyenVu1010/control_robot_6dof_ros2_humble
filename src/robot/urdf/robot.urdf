<?xml version="1.0" encoding="utf-8"?>
<robot name="robot">

  <!-- ======================================================================== -->
  <!-- 1. CỐ ĐỊNH BASE VÀO WORLD                                                -->
  <!-- ======================================================================== -->
  <link name="world"/>
  <joint name="world_joint" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <!-- ======================================================================== -->
  <!-- 2. CÁC LINK VÀ JOINT (Đã sửa đường dẫn package://my_arm_robot)           -->
  <!-- ======================================================================== -->
  
  <link name="base_link">
    <inertial>
      <origin xyz="-0.00011853 2.7498E-07 0.048515" rpy="0 0 0" />
      <mass value="0.467996" />
      <inertia ixx="0.0003618" ixy="6.1402E-11" ixz="-1.379E-07" iyy="0.0003598" iyz="3.0629E-10" izz="0.0005074" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/base_link.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>

  <link name="Link_1">
    <inertial>
      <origin xyz="-0.00044975 0.00048876 0.040226" rpy="0 0 0" />
      <mass value="0.35373" />
      <inertia ixx="0.00023009" ixy="-2.2014E-05" ixz="-1.7013E-05" iyy="0.00023377" iyz="1.8494E-05" izz="0.00018361" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_1.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_1.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_1_joint" type="revolute">
    <origin xyz="0 0 0.1214" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="Link_1" />
    <axis xyz="0 0 1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <link name="Link_2">
    <inertial>
      <origin xyz="0.055 2.8797E-13 0.014552" rpy="0 0 0" />
      <mass value="0.32748" />
      <inertia ixx="0.00014536" ixy="9.7885E-20" ixz="-4.9313E-20" iyy="0.0007689" iyz="1.0029E-18" izz="0.0008667" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_2.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_2.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_2_joint" type="revolute">
    <origin xyz="-0.037236 0.040478 0.046" rpy="1.5708 -1.5643 -2.3979" />
    <parent link="Link_1" />
    <child link="Link_2" />
    <axis xyz="0 0 1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <link name="Link_3">
    <inertial>
      <origin xyz="-0.034199 0.038276 0.05699" rpy="0 0 0" />
      <mass value="0.64467" />
      <inertia ixx="0.00047123" ixy="0.00016492" ixz="-6.6516E-05" iyy="0.00057546" iyz="5.7735E-05" izz="0.00068737" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_3.STL" />
      </geometry>
      <material name=""><color rgba="0.75 0.75 0.75 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_3.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_3_joint" type="revolute">
    <origin xyz="0.11 0 0" rpy="3.1416 0 1.5773" />
    <parent link="Link_2" />
    <child link="Link_3" />
    <axis xyz="0 0 -1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <link name="Link_4">
    <inertial>
      <origin xyz="-0.00034838 0.004039 0.044951" rpy="0 0 0" />
      <mass value="0.35757" />
      <inertia ixx="0.0002534" ixy="-2.5899E-06" ixz="3.5514E-06" iyy="0.00028321" iyz="-4.1184E-05" izz="0.00020218" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_4.STL" />
      </geometry>
      <material name=""><color rgba="0.75 0.75 0.75 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_4.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_4_joint" type="revolute">
    <origin xyz="-0.070463 0.12975 0.055" rpy="-1.5708 0 0.003562" />
    <parent link="Link_3" />
    <child link="Link_4" />
    <axis xyz="0 0 -1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <link name="Link_5">
    <inertial>
      <origin xyz="-0.00035411 0.050355 -0.025313" rpy="0 0 0" />
      <mass value="0.21575" />
      <inertia ixx="0.00028449" ixy="4.9247E-07" ixz="-5.2481E-07" iyy="0.00021388" iyz="7.6133E-05" izz="0.00023773" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_5.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_5.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_5_joint" type="revolute">
    <origin xyz="0.003472 -0.040251 0.056" rpy="1.5708 0.0035488 0.086047" />
    <parent link="Link_4" />
    <child link="Link_5" />
    <axis xyz="0 0 -1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <link name="Link_6">
    <inertial>
      <origin xyz="0.0038357 0.0036673 0.031128" rpy="0 0 0" />
      <mass value="0.025118" />
      <inertia ixx="5.3242E-06" ixy="1.0647E-06" ixz="-4.7551E-08" iyy="4.8673E-06" iyz="-8.8596E-08" izz="2.4979E-06" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_6.STL" />
      </geometry>
      <material name=""><color rgba="0.75 0.75 0.75 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/Link_6.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="Link_6_joint" type="revolute">
    <origin xyz="-0.00059549 0.085198 -0.041" rpy="-1.5708 -0.82976 0.0069894" />
    <parent link="Link_5" />
    <child link="Link_6" />
    <axis xyz="0 0 1" />
    <limit lower="-1.57" upper="1.57" effort="100" velocity="1" />
  </joint>

  <!-- MỚI: GRIPPER RIGHT -->
  <link name="gripper_right">
    <inertial>
      <origin xyz="0.022391 -0.0035934 -0.007" rpy="0 0 0" />
      <mass value="0.0029678" />
      <inertia ixx="7.8507E-08" ixy="1.9967E-07" ixz="-3.3087E-23" iyy="8.4605E-07" iyz="-7.9409E-23" izz="9.1493E-07" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/gripper_right.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/gripper_right.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="gripper_right_joint" type="revolute">
    <origin xyz="-0.008556 0.035448 0.061693" rpy="-1.5708 -1.1863 -0.89493" />
    <parent link="Link_6" />
    <child link="gripper_right" />
    <axis xyz="0 0 1" />
    <limit lower="-1.57" upper="1.57" effort="20" velocity="1" />
  </joint>

  <!-- MỚI: GRIPPER LEFT -->
  <link name="gripper_left">
    <inertial>
      <origin xyz="0.022391 0.0035934 -0.007" rpy="0 0 0" />
      <mass value="0.0029678" />
      <inertia ixx="7.8507E-08" ixy="-1.9967E-07" ixz="3.9705E-23" iyy="8.4605E-07" iyz="2.647E-23" izz="9.1493E-07" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/gripper_left.STL" />
      </geometry>
      <material name=""><color rgba="0.79 0.82 0.93 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://my_arm_robot/meshes/gripper_left.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="gripper_left_joint" type="revolute">
    <origin xyz="0.032692 -0.015993 0.061756" rpy="1.5708 -1.1863 2.2467" />
    <parent link="Link_6" />
    <child link="gripper_left" />
    <axis xyz="0 0 1" />
    <limit lower="-1.57" upper="1.57" effort="20" velocity="1" />
    <!-- Chú ý: Left bắt chước Right -->
    <mimic joint="gripper_right_joint" multiplier="-1" offset="0" />
  </joint>
  <link name="tool_center_point" />

  <joint name="tcp_joint" type="fixed">
    <parent link="Link_6"/>
    <child link="tool_center_point"/>
    <!-- QUAN TRỌNG: Cần chỉnh xyz và rpy ở đây -->
    <!-- Giả sử kẹp dài khoảng 15cm (0.15m) dọc theo trục Z của Link_6 -->
    <!-- Bạn cần đo thực tế từ mặt bích Link_6 đến điểm giữa 2 đầu ngón tay -->
    <origin xyz="0 0 0.15" rpy="0 0 0"/> 
  </joint>
  <!-- ======================================================================== -->
  <!-- 3. ROS2 CONTROL (Cập nhật tên khớp Kẹp Mới)                              -->
  <!-- ======================================================================== -->
  <ros2_control name="RobotSystem" type="system">
    <hardware>
      <plugin>mock_components/GenericSystem</plugin>
      <param name="calculate_dynamics">true</param>
    </hardware>

    <joint name="Link_1_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="Link_2_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="Link_3_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="Link_4_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="Link_5_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="Link_6_joint"><command_interface name="velocity"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    
    <!-- CẬP NHẬT TÊN KHỚP KẸP CHÍNH -->
    <joint name="gripper_right_joint">
      <command_interface name="position"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    
  </ros2_control>

</robot>			
